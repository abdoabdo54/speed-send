#!/bin/bash

echo "========================================"
echo "üî• IMMEDIATE LAUNCH FIX"
echo "========================================"
echo ""

cd /opt/speed-send || exit 1

echo "1Ô∏è‚É£ Stopping backend..."
docker-compose stop backend

echo ""
echo "2Ô∏è‚É£ Pulling latest fix..."
git stash
git pull origin main

echo ""
echo "3Ô∏è‚É£ Rebuilding backend..."
docker-compose build --no-cache backend

echo ""
echo "4Ô∏è‚É£ Starting backend..."
docker-compose up -d backend

echo ""
echo "5Ô∏è‚É£ Waiting for backend..."
sleep 10

echo ""
echo "6Ô∏è‚É£ Testing backend..."
curl -s http://localhost:8000/health && echo "‚úÖ Backend OK" || echo "‚ùå Backend not ready"

echo ""
echo "========================================"
echo "‚úÖ FIX APPLIED - TEST NOW!"
echo "========================================"
echo ""
echo "üåê Go to: http://172.236.219.75:3000/campaigns"
echo "üéØ Click üöÄ Launch on any DRAFT campaign"
echo ""
